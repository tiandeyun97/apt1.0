<!-- 对账详情模态框模板 - 可在等待对账、异常对账、完成对账页面共用 -->
<div class="modal fade" id="detailModal" tabindex="-1" aria-labelledby="detailModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="detailModalLabel">
                    <i class="fas fa-info-circle me-2 text-info"></i>对账详情
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body p-0">
                <!-- 顶部信息区 -->
                <div class="detail-header p-4 border-bottom">
                    <div class="d-flex justify-content-between align-items-start mb-3">
                        <h4 id="detail-task" class="mb-0 text-primary"></h4>
                        <span id="detail-status-badge" class="badge rounded-pill"></span>
                    </div>
                    <div class="detail-meta d-flex flex-wrap gap-3">
                        <span class="detail-meta-item d-flex align-items-center">
                            <i class="fas fa-folder me-2 text-muted"></i>
                            <span id="detail-project" class="fw-medium"></span>
                        </span>
                        <span class="detail-meta-item d-flex align-items-center">
                            <i class="fas fa-calendar me-2 text-muted"></i>
                            <span id="detail-period" class="fw-medium"></span>
                        </span>
                        <span class="detail-meta-item d-flex align-items-center">
                            <i class="fas fa-clock me-2 text-muted"></i>
                            <span id="detail-created-at" class="fw-medium"></span>
                        </span>
                    </div>
                    <div class="detail-optimizer mt-2">
                        <span class="detail-meta-item d-flex align-items-center">
                            <i class="fas fa-user me-2 text-primary"></i>
                            <span class="text-muted me-2">优化师:</span>
                            <div id="detail-optimizers" class="optimizer-badges">
                                <!-- 优化师信息将通过JavaScript动态添加 -->
                            </div>
                        </span>
                    </div>
                </div>
                
                <!-- 主要内容区 -->
                <div class="p-4">
                    <div class="row">
                        <!-- 对账数据 -->
                        <div class="col-md-6 mb-4">
                            <div class="card h-100 shadow-sm border-0">
                                <div class="card-header bg-white">
                                    <h6 class="fw-bold mb-0">对账数据</h6>
                                </div>
                                <div class="card-body">
                                    <div class="consumption-stats">
                                        <div class="consumption-stat">
                                            <div class="stat-icon bg-primary-light rounded-circle">
                                                <i class="fas fa-coins text-primary"></i>
                                            </div>
                                            <div class="stat-content">
                                                <div class="stat-value" id="detail-actual-consumption">¥0.00</div>
                                                <div class="stat-label">实际消耗</div>
                                            </div>
                                        </div>
                                        
                                        <div class="consumption-stat">
                                            <div class="stat-icon bg-info-light rounded-circle">
                                                <i class="fab fa-facebook text-info"></i>
                                            </div>
                                            <div class="stat-content">
                                                <div class="stat-value" id="detail-fb-consumption">未填写</div>
                                                <div class="stat-label">FB消耗</div>
                                            </div>
                                        </div>
                                        
                                        <div class="consumption-stat">
                                            <div class="stat-icon bg-warning-light rounded-circle" id="diff-icon-container">
                                                <i class="fas fa-calculator text-warning" id="diff-icon"></i>
                                            </div>
                                            <div class="stat-content">
                                                <div class="d-flex align-items-center">
                                                    <div class="stat-value" id="detail-difference">¥0.00</div>
                                                    <span class="badge ms-2" id="diff-badge"></span>
                                                </div>
                                                <div class="stat-label">差异金额</div>
                                                <div class="stat-percentage" id="detail-difference-percentage">0.00%</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- 备注信息 -->
                                    <div class="mt-3 pt-3 border-top" id="note-container">
                                        <div class="d-flex">
                                            <div class="flex-shrink-0">
                                                <i class="fas fa-sticky-note text-muted"></i>
                                            </div>
                                            <div class="flex-grow-1 ms-2">
                                                <h6 class="text-muted fw-medium mb-1">备注</h6>
                                                <p class="mb-0" id="detail-note">暂无备注</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 历史记录 -->
                        <div class="col-md-6 mb-4">
                            <div class="card h-100 shadow-sm border-0">
                                <div class="card-header bg-white">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <h6 class="fw-bold mb-0">历史对账记录</h6>
                                        <span class="badge bg-primary rounded-pill" id="history-count">0</span>
                                    </div>
                                </div>
                                <div class="card-body p-0">
                                    <!-- 加载中状态 -->
                                    <div id="history-loading" class="text-center p-4">
                                        <div class="spinner-border text-primary spinner-border-sm" role="status"></div>
                                        <p class="mb-0 mt-2 text-muted">加载历史记录中...</p>
                                    </div>
                                    
                                    <!-- 历史记录列表 -->
                                    <div class="history-timeline" id="history-list">
                                        <!-- 历史记录将通过JavaScript动态填充 -->
                                    </div>
                                    
                                    <!-- 暂无历史记录 -->
                                    <div id="no-history" class="text-center p-4 d-none">
                                        <i class="fas fa-history text-muted mb-2" style="font-size: 2rem;"></i>
                                        <p class="mb-0 text-muted">暂无历史记录</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- 附件展示区域 -->
                        <div class="col-12 mb-4" id="attachments-container">
                            <div class="card shadow-sm border-0">
                                <div class="card-header bg-white">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <h6 class="fw-bold mb-0">对账凭证</h6>
                                        <span class="badge bg-secondary rounded-pill" id="attachment-count">0</span>
                                    </div>
                                </div>
                                <div class="card-body p-0">
                                    <!-- 加载中状态 -->
                                    <div id="attachments-loading" class="text-center p-4">
                                        <div class="spinner-border text-primary spinner-border-sm" role="status"></div>
                                        <p class="mb-0 mt-2 text-muted">加载附件中...</p>
                                    </div>
                                    
                                    <!-- 附件列表 -->
                                    <div class="p-3" id="attachments-list">
                                        <!-- 附件将通过JavaScript动态填充 -->
                                    </div>
                                    
                                    <!-- 暂无附件 -->
                                    <div id="no-attachments" class="text-center p-4 d-none">
                                        <i class="fas fa-file-image text-muted mb-2" style="font-size: 2rem;"></i>
                                        <p class="mb-0 text-muted">暂无对账凭证</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">关闭</button>
                <div id="detail-action-buttons">
                    <!-- 动态添加的操作按钮将显示在这里 -->
                </div>
            </div>
        </div>
    </div>
</div> 